<!DOCTYPE html><html lang="el">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Αίτηση Ειδικής Άδειας</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background-color: #f9f9f9; text-align: center; }
    input, textarea, button { width: 90%; padding: 10px; margin: 10px 0; font-size: 16px; border-radius: 5px; border: 1px solid #ccc; }
    button { background-color: #28a745; color: white; cursor: pointer; }
    h1 { color: #333; }
    #status { font-weight: bold; margin-top: 10px; color: darkred; }
  </style>
</head>
<body>
  <h1>Αίτηση Ειδικής Άδειας Μπόμπου</h1>  <input id="name" placeholder="Ονοματεπώνυμο">
  <input id="destination" placeholder="Προορισμός">
  <input id="dates" placeholder="Διάστημα άδειας (π.χ. 02/05 - 06/05)">  <textarea id="requestText" placeholder="Γράψε ευγενικά το αίτημα σου για άδεια..."></textarea>  <h3>📜 Όροι και Προϋποθέσεις:</h3>
  <ul style="text-align: left; max-width: 500px; margin: auto;">
    <li>Θα είμαι φρόνιμη καθ' όλη τη διάρκεια της άδειας</li>
    <li>Θα ενημερώνω εγκαίρως για κάθε μου κίνηση</li>
    <li>Αναγνωρίζω την απόλυτη εξουσία του Αφεντικού</li>
  </ul><button id="recordBtn">🎤 Ηχογράφησε την ανάγνωση των όρων</button> <button id="stopBtn" disabled>⏹ Διακοπή</button>

  <p id="recordingStatus">Δεν έχει ξεκινήσει η ηχογράφηση</p>  <h3>🖼 Φωτογραφία με ύφος μεταμέλειας:</h3>
  <input type="file" id="imageUpload" accept="image/*"><button onclick="submitApplication()">📤 Υποβολή στο Αφεντικό</button>

  <p id="status"></p>  <script>
    let mediaRecorder, audioBlob, audioChunks = [];

    document.getElementById("recordBtn").onclick = async function() {
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      mediaRecorder = new MediaRecorder(stream);
      audioChunks = [];
      mediaRecorder.start();
      document.getElementById("recordingStatus").textContent = "🔴 Ηχογράφηση σε εξέλιξη...";
      this.disabled = true;
      document.getElementById("stopBtn").disabled = false;

      mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
      mediaRecorder.onstop = () => {
        audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
        document.getElementById("recordingStatus").textContent = "✔️ Ολοκληρώθηκε!";
      };
    };

    document.getElementById("stopBtn").onclick = function() {
      mediaRecorder.stop();
      this.disabled = true;
      document.getElementById("recordBtn").disabled = false;
    };

    function submitApplication() {
      const name = document.getElementById("name").value;
      const destination = document.getElementById("destination").value;
      const dates = document.getElementById("dates").value;
      const request = document.getElementById("requestText").value;
      const image = document.getElementById("imageUpload").files[0];

      if (!name || !destination || !dates || !request || !audioBlob || !image) {
        document.getElementById("status").textContent = "❗ Συμπλήρωσε όλα τα πεδία και ανέβασε ηχογράφηση και φωτογραφία!";
        return;
      }

      document.getElementById("status").textContent = "⏳ Αποστολή στο Αφεντικό...";

      const formData = new FormData();
      formData.append("photo", image);
      formData.append("caption", `📝 Αίτηση Ειδικής Άδειας\nΟνοματεπώνυμο: ${name}\nΠροορισμός: ${destination}\nΗμερομηνίες: ${dates}\nΑίτημα: ${request}`);

      const botToken = "YOUR_BOT_TOKEN";
      const chatId = "YOUR_CHAT_ID";

      fetch(`https://api.telegram.org/bot${botToken}/sendPhoto?chat_id=${chatId}`, {
        method: "POST",
        body: formData
      })
      .then(() => {
        const voiceForm = new FormData();
        voiceForm.append("voice", audioBlob);
        return fetch(`https://api.telegram.org/bot${botToken}/sendVoice?chat_id=${chatId}`, {
          method: "POST",
          body: voiceForm
        });
      })
      .then(() => {
        document.getElementById("status").textContent = "✅ Υποβλήθηκε με επιτυχία! Αναμονή έγκρισης...";
      })
      .catch(err => {
        console.error(err);
        document.getElementById("status").textContent = "❌ Κάτι πήγε στραβά στην αποστολή.";
      });
    }
  </script></body>
</html>
