<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Italian Gift Journey ğŸ‡®ğŸ‡¹</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #009246, #ffffff, #ce2b37); /* Italian Flag */
            text-align: center;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            color: #333;
        }

        h1 {
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            font-size: 1.8em;
            margin-bottom: 30px;
        }

        .map-container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .city-stop {
            margin: 15px 0;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 15px;
            background: #fff;
            transition: all 0.3s ease;
        }

        /* ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·: ÎšÎ»ÎµÎ¹Î´Ï‰Î¼Î­Î½Î¿ */
        .city-stop.locked {
            opacity: 0.6;
            filter: grayscale(100%);
            pointer-events: none;
            background: #f0f0f0;
        }

        /* ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·: Î•Î½ÎµÏÎ³ÏŒ (Î¤ÏÎ­Ï‡Î¿Î½) */
        .city-stop.active {
            border-color: #009246;
            transform: scale(1.03);
            box-shadow: 0 5px 15px rgba(0,146,70,0.3);
            border-width: 3px;
        }

        /* ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·: ÎŸÎ»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î¿ */
        .city-stop.completed {
            border-color: #ce2b37;
            background: #ffebeb;
            opacity: 0.8;
        }

        h2 { margin: 0 0 5px 0; font-size: 1.2rem; }
        p { margin: 5px 0; font-size: 0.9rem; }

        button {
            background: #009246;
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 10px;
            font-weight: bold;
            transition: background 0.3s;
        }

        button:hover { background: #007a3a; }
        button:disabled { background: #ccc; cursor: default; }

        /* --- MODAL (Game Window) --- */
        #gameModal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 100;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .modal-content {
            background: white;
            color: #333;
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            max-width: 90%;
            width: 320px;
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 25px;
            cursor: pointer;
            color: #999;
        }

        #gameCanvas {
            background: #444;
            display: block;
            margin: 10px auto;
            border-radius: 5px;
        }

        .hidden { display: none !important; }

        /* Styles for simple HTML games */
        .game-btn-big {
            font-size: 2rem;
            padding: 15px;
            margin-top: 20px;
            background: #ce2b37;
            color: white;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            border: none;
            cursor: pointer;
        }

        .choice-btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: #eee;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
        }
        .choice-btn:hover { background: #ddd; }

        .anim-box {
            font-size: 60px;
            margin: 20px 0;
        }

    </style>
</head>
<body>

    <h1>ğŸ‡®ğŸ‡¹ Î¤Î¿ Î¤Î±Î¾Î¯Î´Î¹ ÎÎµÎºÎ¹Î½Î¬! ğŸ‡®ğŸ‡¹</h1>

    <div class="map-container">
        
        <div id="city-1" class="city-stop active">
            <h2>1. ÎœÎ¹Î»Î¬Î½Î¿ ğŸ‘ </h2>
            <p>Î— Î¼ÏŒÎ´Î± ÏƒÏ…Î½Î±Î½Ï„Î¬ Ï„Î·Î½ ÎºÎ¯Î½Î·ÏƒÎ·!</p>
            <button onclick="setupGame(1)">Start Trip</button>
        </div>

        <div id="city-2" class="city-stop locked">
            <h2>2. ÎœÎ±ÏÎ±Î½Î­Î»Î¿ ğŸï¸</h2>
            <p>Î ÏÎ¿ÏƒÎ´ÎµÎ¸ÎµÎ¯Ï„Îµ...</p>
            <button onclick="setupGame(2)">Start Engine</button>
        </div>

        <div id="city-3" class="city-stop locked">
            <h2>3. ÎœÏŒÎ½Ï„ÎµÎ½Î± ğŸ§¦</h2>
            <p>Î§ÏÎµÎ¹Î¬Î¶ÎµÏƒÎ±Î¹ Î¶ÎµÏƒÏ„Î±ÏƒÎ¹Î¬;</p>
            <button onclick="setupGame(3)">Warm Up</button>
        </div>

        <div id="city-4" class="city-stop locked">
            <h2>4. Î¦Î»Ï‰ÏÎµÎ½Ï„Î¯Î± ğŸ§™â€â™€ï¸</h2>
            <p>ÎœÎ±Î³ÎµÎ¯Î± ÏƒÏ„Î·Î½ Î¤Î¿ÏƒÎºÎ¬Î½Î·...</p>
            <button onclick="setupGame(4)">Fly High</button>
        </div>

        <div id="city-5" class="city-stop locked">
            <h2>5. ÎœÏ€Î¿Î»ÏŒÎ½Î¹Î± ğŸ</h2>
            <p>Î¤Î¿ ÎœÎµÎ³Î¬Î»Î¿ Î¦Î¹Î½Î¬Î»Îµ!</p>
            <button onclick="setupGame(5)">Final Taste</button>
        </div>

    </div>

    <div id="gameModal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">Ã—</span>
            <h2 id="gTitle">Game Title</h2>
            <p id="gInstr">Instructions</p>
            
            <div id="gameArea"></div>
            
            <h3 id="resultMsg" style="color: #009246; min-height: 25px; margin-top:10px;"></h3>
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        const totalLevels = 5;

        // --- GAME LAUNCHER ---
        function setupGame(level) {
            const modal = document.getElementById('gameModal');
            const title = document.getElementById('gTitle');
            const instr = document.getElementById('gInstr');
            const area = document.getElementById('gameArea');
            const res = document.getElementById('resultMsg');

            modal.style.display = 'flex';
            area.innerHTML = '';
            res.innerText = '';

            if (level === 1) {
                // MILANO: Car Obstacles
                title.innerText = "ÎœÎ¹Î»Î¬Î½Î¿: Traffic Jam!";
                instr.innerText = "ÎŸÎ´Î®Î³Î·ÏƒÎµ Ï„Î¿ Î±Î¼Î±Î¾Î¬ÎºÎ¹ (ÎºÎ»Î¹Îº Î±ÏÎ¹ÏƒÏ„ÎµÏÎ¬/Î´ÎµÎ¾Î¹Î¬) ÎºÎ±Î¹ Î±Ï€ÏŒÏ†Ï…Î³Îµ Ï„Î± ÎµÎ¼Ï€ÏŒÎ´Î¹Î±!";
                area.innerHTML = '<canvas id="gameCanvas" width="250" height="300"></canvas>';
                runCarGame(level);
            } 
            else if (level === 2) {
                // MARANELLO: Reflexes
                title.innerText = "ÎœÎ±ÏÎ±Î½Î­Î»Î¿: F1 Start";
                instr.innerText = "Î ÎµÏÎ¯Î¼ÎµÎ½Îµ Î½Î± Î³Î¯Î½ÎµÎ¹ Î Î¡Î‘Î£Î™ÎÎŸ ÎºÎ±Î¹ Ï€Î¬Ï„Î± Î±Î¼Î­ÏƒÏ‰Ï‚!";
                area.innerHTML = `
                    <div id="light" style="width:80px; height:80px; background:red; border-radius:50%; margin:10px auto; border: 3px solid #333;"></div>
                    <button id="reflexBtn" style="margin-top:10px;">GO!</button>
                `;
                runReflexGame(level);
            }
            else if (level === 3) {
                // MODENA: Warm Up
                title.innerText = "ÎœÏŒÎ½Ï„ÎµÎ½Î±: ÎšÏÏ…ÏÎ½ÎµÎ¹Ï‚;";
                instr.innerText = "Î Î¬Ï„Î± Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯ Î³ÏÎ®Î³Î¿ÏÎ± 10 Ï†Î¿ÏÎ­Ï‚ Î³Î¹Î± Î½Î± Î±Î½Î­Î²ÎµÎ¹ Î· Î¸ÎµÏÎ¼Î¿ÎºÏÎ±ÏƒÎ¯Î±!";
                area.innerHTML = `<button class="game-btn-big" id="warmBtn">â„ï¸</button>`;
                runWarmUpGame(level);
            }
            else if (level === 4) {
                // FLORENCE: Witch
                title.innerText = "Î¦Î»Ï‰ÏÎµÎ½Ï„Î¯Î±: La Befana";
                instr.innerText = "Î— Î¼Î¬Î³Î¹ÏƒÏƒÎ± Ï€ÎµÏ„Î¬ÎµÎ¹... Î Î¹Î¬ÏƒÎµ Ï„Î¿ Î´ÏÏÎ¿!";
                area.innerHTML = `
                    <div class="anim-box" style="animation: bounce 2s infinite;">ğŸ§™â€â™€ï¸</div>
                    <style>@keyframes bounce { 0%, 100% {transform: translateY(0);} 50% {transform: translateY(-20px);} }</style>
                    <button onclick="winLevel(4)" style="margin-top:20px;">Î†Î½Î¿Î¹Î¾Îµ Ï„Î¿ Î£Î¬ÎºÎ¿!</button>
                `;
            }
            else if (level === 5) {
                // BOLOGNA: Quiz
                title.innerText = "ÎœÏ€Î¿Î»ÏŒÎ½Î¹Î±: The Quiz";
                instr.innerText = "Î Î¿Î¹Î¿ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Ï„Î·Ï‚ ÎµÏ…Ï„Ï…Ï‡Î¯Î±Ï‚ ÏƒÏ„Î·Î½ Î™Ï„Î±Î»Î¯Î±;";
                area.innerHTML = `
                    <button class="choice-btn" onclick="alert('Î£Ï‡ÎµÎ´ÏŒÎ½...')">Diet Coke</button>
                    <button class="choice-btn" onclick="winLevel(5)">Pasta & Dolce</button>
                    <button class="choice-btn" onclick="alert('Î Î¿Î»Ï Î¬Î³Ï‡Î¿Ï‚!')">Î”Î¿Ï…Î»ÎµÎ¹Î¬</button>
                `;
            }
        }

        // --- SPECIFIC GAME LOGIC ---

        function runCarGame(level) {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            let carX = 100; // 0 to 250 width
            let obstacles = [];
            let running = true;
            let score = 0;

            function draw() {
                if (!running) return;
                ctx.clearRect(0,0,250,300);
                
                // Player Car
                ctx.font = "30px Arial";
                ctx.fillText("ğŸš—", carX, 270);

                // Spawn Obstacles
                if (Math.random() < 0.04) {
                    obstacles.push({x: Math.random() * 220, y: 0});
                }

                obstacles.forEach((obs) => {
                    obs.y += 3; 
                    ctx.fillText("ğŸš§", obs.x, obs.y);
                    
                    // Collision Check
                    if (obs.y > 240 && obs.y < 280 && Math.abs(obs.x - carX) < 25) {
                        running = false;
                        alert("Î©Ï‡! Î¤ÏÎ¬ÎºÎ±ÏÎµÏ‚! ÎÎ±Î½Î±Ï€ÏÎ¿ÏƒÏ€Î¬Î¸Î·ÏƒÎµ.");
                        runCarGame(level); // Restart
                    }
                });

                // Win Condition
                score++;
                ctx.fillStyle = "#fff";
                ctx.font = "15px Arial";
                ctx.fillText("Score: " + score, 10, 20);

                if (score > 400) {
                    running = false;
                    winLevel(level);
                } else {
                    requestAnimationFrame(draw);
                }
            }

            // Controls
            canvas.onclick = (e) => {
                if (e.offsetX < 125) carX -= 40;
                else carX += 40;
                // Bounds
                if (carX < 0) carX = 0;
                if (carX > 220) carX = 220;
            };

            draw();
        }

        function runReflexGame(level) {
            const light = document.getElementById('light');
            const btn = document.getElementById('reflexBtn');
            let ready = false;
            let tooEarly = false;

            btn.onclick = () => {
                if (tooEarly) return;
                if (ready) {
                    winLevel(level);
                } else {
                    tooEarly = true;
                    alert("Î Î¿Î»Ï Î½Ï‰ÏÎ¯Ï‚! +2 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î± Ï€Î¿Î¹Î½Î®.");
                    setTimeout(() => { 
                        tooEarly = false; 
                        setupGame(level); // Restart
                    }, 500); 
                }
            };

            setTimeout(() => {
                if(!tooEarly) {
                    light.style.background = '#00ff00'; // Green
                    light.style.boxShadow = '0 0 20px #00ff00';
                    ready = true;
                }
            }, 2000 + Math.random() * 2000);
        }

        function runWarmUpGame(level) {
            let clicks = 0;
            const btn = document.getElementById('warmBtn');
            btn.onclick = () => {
                clicks++;
                btn.innerText = clicks + "/10";
                if (clicks >= 10) {
                    btn.innerText = "ğŸ”¥";
                    winLevel(level);
                }
            }
        }

        // --- GLOBAL STATE ---

        function winLevel(level) {
            const res = document.getElementById('resultMsg');
            res.innerText = "ğŸ‰ ÎœÎ Î¡Î‘Î’ÎŸ! Î‘ÎÎŸÎ™ÎÎ• Î¤ÎŸ Î”Î©Î¡ÎŸ " + level + "! ğŸ‰";
            
            // Mark Map
            const currentDiv = document.getElementById('city-' + level);
            currentDiv.classList.remove('active');
            currentDiv.classList.add('completed');
            currentDiv.querySelector('button').innerText = "Î‘Î½Î¿Î¯Ï‡Ï„Î·ÎºÎµ âœ…";
            currentDiv.querySelector('button').disabled = true;

            setTimeout(() => {
                closeModal();
                if (level < totalLevels) {
                    // Unlock Next
                    const nextDiv = document.getElementById('city-' + (level+1));
                    nextDiv.classList.remove('locked');
                    nextDiv.classList.add('active');
                    nextDiv.scrollIntoView({ behavior: 'smooth' });
                } else {
                    // END GAME
                    alert("ğŸ‡®ğŸ‡¹ Î£Ï…Î³Ï‡Î±ÏÎ·Ï„Î®ÏÎ¹Î±! ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎµÏ‚ Ï„Î¿ Î™Ï„Î±Î»Î¹ÎºÏŒ Î¤Î±Î¾Î¯Î´Î¹! â¤ï¸");
                }
            }, 2500);
        }

        function closeModal() {
            document.getElementById('gameModal').style.display = 'none';
        }

    </script>
</body>
</html>

