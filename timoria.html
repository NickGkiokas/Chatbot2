<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Î— ÎœÎµÎ³Î¬Î»Î· Î¤Î¹Î¼Ï‰ÏÎ¯Î± ğŸ“œ</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #1a1a1a;
            --accent-red: #ff3333;
            --text-color: #f0f0f0;
            --flag-green: #009246;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            margin: 0; padding: 0; height: 100vh; overflow: hidden;
            background: var(--bg-color); color: var(--text-color);
            display: flex; flex-direction: column; user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        h1 {
            text-align: center; margin: 15px 0; z-index: 10; font-size: 1.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            position: absolute; width: 100%; top: 0; pointer-events: none;
        }

        /* CONTAINER ZONES */
        .container { display: flex; width: 100%; height: 100%; }
        .zone {
            width: 50%; height: 100%; display: flex; flex-direction: column;
            justify-content: center; align-items: center; transition: opacity 0.3s;
        }
        .naughty { background: linear-gradient(135deg, #8b0000, #500000); border-right: 1px solid #ffffff33; }
        .nice { background: linear-gradient(135deg, #006400, #004d00); }
        .icon { font-size: 3rem; opacity: 0.6; margin-bottom: 10px; }
        .zone-title { font-size: 1.2rem; font-weight: 900; opacity: 0.8; letter-spacing: 2px; }

        /* DRAGGABLE */
        #draggable-name {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: white; color: #333; padding: 15px 30px; border-radius: 50px;
            font-size: 1.2rem; font-weight: 800; box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            cursor: grab; z-index: 100; touch-action: none; border: 4px solid #d4af37;
        }

        /* MODALS */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 200;
            justify-content: center; align-items: center; padding: 20px; box-sizing: border-box;
        }

        .modal-content {
            background: #222; color: white; text-align: center; padding: 25px;
            border-radius: 20px; width: 100%; max-width: 400px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.8); border: 1px solid #444;
            max-height: 85vh; overflow-y: auto; position: relative;
        }

        /* TEXT & BUTTONS */
        h2 { color: var(--accent-red); margin-top: 0; font-size: 1.5rem; }
        h3 { color: #aaa; font-size: 1.1rem; margin-bottom: 15px; }
        p { line-height: 1.6; color: #ccc; font-size: 0.95rem; margin-bottom: 20px; }

        .btn {
            background: white; color: black; border: none; padding: 15px 30px;
            font-size: 1rem; font-weight: bold; border-radius: 50px; cursor: pointer;
            width: 100%; margin-top: 10px; transition: transform 0.05s;
            box-shadow: 0 5px 15px rgba(255,255,255,0.1);
        }
        .btn:active { transform: scale(0.95); }
        .btn-red { background: var(--accent-red); color: white; }
        .btn-green { background: var(--flag-green); color: white; }
        .quiz-btn { background: #333; color: white; border: 1px solid #555; text-align: left; }
        
        /* MASH BUTTON STYLES */
        .mash-btn {
            width: 150px; height: 150px; border-radius: 50%;
            background: radial-gradient(circle, #ff5555, #990000);
            border: 5px solid white; color: white; font-size: 1.2rem; font-weight: 900;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.5);
            margin: 20px auto; display: flex; justify-content: center; align-items: center;
            cursor: pointer; user-select: none; -webkit-touch-callout: none;
            touch-action: manipulation; /* Prevents double-tap zoom */
        }
        .mash-btn:active { transform: scale(0.9); background: radial-gradient(circle, #990000, #ff5555); }

        /* CORNER UI */
        #cornerUI {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: black; z-index: 500; flex-direction: column;
            justify-content: center; align-items: center; color: white;
        }
        #timerDisplay { font-size: 5rem; font-weight: 900; font-family: monospace; color: var(--accent-red); transition: color 0.3s; }
        .keep-awake-btn {
            margin-top: 50px; padding: 20px; border-radius: 50%; width: 100px; height: 100px;
            background: #333; border: 2px solid #555; color: #888; font-size: 0.8rem;
        }

        /* LOADING BAR */
        .progress-container { width: 100%; height: 20px; background: #444; border-radius: 10px; margin-top: 15px; overflow: hidden; border: 1px solid #666; }
        .progress-bar { width: 0%; height: 100%; background: linear-gradient(90deg, #ff9900, #ff0000); transition: width 0.1s linear; }
        
        .info-text { font-style: italic; color: #ddd; margin-bottom: 20px; }
        
        textarea {
            width: 100%; height: 100px; background: #333; color: white; 
            border: 1px solid #555; border-radius: 10px; padding: 10px; 
            font-family: inherit; resize: none; box-sizing: border-box;
        }

    </style>
</head>
<body>

    <h1>ÎšÎ¡Î™Î£Î— & Î¤Î™ÎœÎ©Î¡Î™Î‘ âš–ï¸</h1>

    <div class="container" id="dragGame">
        <div class="zone naughty" id="zone-naughty">
            <div class="icon">ğŸ˜ˆ</div>
            <div class="zone-title">NAUGHTY</div>
        </div>
        <div class="zone nice" id="zone-nice">
            <div class="icon">ğŸ˜‡</div>
            <div class="zone-title">NICE</div>
        </div>
    </div>
    <div id="draggable-name">Î£Î‘Î¡Î‘</div>


    <div id="evalQuizModal" class="modal">
        <div class="modal-content">
            <h2 style="color:var(--flag-green);">Î‘ÎÎ™ÎŸÎ›ÎŸÎ“Î—Î£Î—</h2>
            <div id="evalQuestion" style="font-weight:bold; font-size:1.1rem; margin-bottom:15px; color:#fff;"></div>
            <div id="evalOptions"></div>
        </div>
    </div>

    <div id="analysisModal" class="modal">
        <div class="modal-content">
            <div style="font-size: 3rem;">ğŸ¤–</div>
            <h2 style="color: #00ff00;">Î‘ÎÎ‘Î›Î¥Î£Î—</h2>
            <p id="analysisText">Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î±Ï€Î±Î½Ï„Î®ÏƒÎµÏ‰Î½...</p>
            <div class="progress-container" style="height:10px;"><div class="progress-bar" id="analysisBar" style="background:var(--flag-green);"></div></div>
        </div>
    </div>


    <div id="punishIntroModal" class="modal">
        <div class="modal-content">
            <div style="font-size: 4rem;">ğŸš¨</div>
            <h2>Î•Î§Î•Î™Î£ ÎšÎ¡Î™Î˜Î•Î™ Î•ÎÎŸÎ§Î—!</h2>
            <p>Î¤Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± ÎµÎ½Ï„ÏŒÏ€Î¹ÏƒÎµ Ï€Î¿Î»Î»Î±Ï€Î»Î­Ï‚ Ï€Î±ÏÎ±Î²Î¬ÏƒÎµÎ¹Ï‚. Î”ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯Ï‚ Î½Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÎ¹Ï‚ Ï„Î¿ Ï„Î±Î¾Î¯Î´Î¹ Î±Î½ Î´ÎµÎ½ ÎµÎºÏ„Î¯ÏƒÎµÎ¹Ï‚ Ï„Î·Î½ Ï€Î¿Î¹Î½Î® ÏƒÎ¿Ï….</p>
            <button class="btn btn-red" onclick="startReasonModal()">Î‘Ï€Î¿Î´Î¿Ï‡Î® Î¤Î¹Î¼Ï‰ÏÎ¯Î±Ï‚</button>
        </div>
    </div>
    
    <div id="reasonModal" class="modal">
        <div class="modal-content">
            <h2>ÎŸÎœÎŸÎ›ÎŸÎ“Î™Î‘</h2>
            <p>Î ÏÎ¹Î½ Î¾ÎµÎºÎ¹Î½Î®ÏƒÎ¿Ï…Î¼Îµ, Î³ÏÎ¬ÏˆÎµ Ï„Î¿Î½ Î»ÏŒÎ³Î¿ Ï€Î¿Ï… Ï„Î¹Î¼Ï‰ÏÎµÎ¯ÏƒÎ±Î¹.</p>
            <p style="font-size:0.8rem; color:#888; margin-bottom:5px;">(Î“ÏÎ¬ÏˆÎµ: "ÎœÏ€Î±Î¯Î½Ï‰ Ï„Î¹Î¼Ï‰ÏÎ¯Î± Î³Î¹Î±Ï„Î¯...")</p>
            <textarea id="reasonInput" placeholder="Î“ÏÎ¬ÏˆÎµ ÎµÎ´Ï Ï„Î¿Î½ Î»ÏŒÎ³Î¿..."></textarea>
            <button class="btn btn-red" onclick="sendReason()">Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® & ÎˆÎ½Î±ÏÎ¾Î·</button>
        </div>
    </div>

    <div id="infoPreQuiz" class="modal">
        <div class="modal-content">
            <h3>Î’Î®Î¼Î± 1</h3>
            <p class="info-text">"Î“Î¹Î± Î½Î± Î´Î¿ÏÎ¼Îµ Î±Î½ Î­Î²Î±Î»ÎµÏ‚ Î¼Ï…Î±Î»ÏŒ... Î‘Ï€Î¬Î½Ï„Î·ÏƒÎµ ÏƒÏ‰ÏƒÏ„Î¬ ÏƒÏ„Î¹Ï‚ ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚."</p>
            <button class="btn" onclick="startPunishQuiz()">Î£Ï…Î½Î­Ï‡ÎµÎ¹Î±</button>
        </div>
    </div>

    <div id="punishQuizModal" class="modal">
        <div class="modal-content">
            <h2>Î£Î¤Î‘Î”Î™ÎŸ 1: Î‘ÎÎ‘ÎšÎ¡Î™Î£Î—</h2>
            <div id="punishQuestion" style="font-weight:bold; font-size:1.1rem; margin-bottom:15px; color:#fff;"></div>
            <div id="punishOptions"></div>
        </div>
    </div>

    <div id="infoPreWrite" class="modal">
        <div class="modal-content">
            <h3>Î’Î®Î¼Î± 2</h3>
            <p class="info-text">"ÎÏÎ± Î³Î¹Î± ÎµÎ¾Î¬ÏƒÎºÎ·ÏƒÎ·. Î Î¬ÏÎµ Ï‡Î±ÏÏ„Î¯ ÎºÎ±Î¹ ÏƒÏ„Ï…Î»ÏŒ Î¤Î©Î¡Î‘!"</p>
            <button class="btn" onclick="startHandwriting()">Î£Ï…Î½Î­Ï‡ÎµÎ¹Î±</button>
        </div>
    </div>

    <div id="handwritingModal" class="modal">
        <div class="modal-content">
            <h2>Î£Î¤Î‘Î”Î™ÎŸ 2: Î“Î¡Î‘Î¦Î—</h2>
            <p>Î“ÏÎ¬ÏˆÎµ <strong>10 Ï†Î¿ÏÎ­Ï‚</strong>:</p>
            <div style="background:#333; padding:10px; border-radius:10px; margin:10px 0; color:#00ff00; font-family:monospace;">
                "SarÃ² una brava ragazza quest'anno"
            </div>
            <p>Î‘Î½Î­Î²Î±ÏƒÎµ Ï†Ï‰Ï„Î¿Î³ÏÎ±Ï†Î¯Î±:</p>
            <input type="file" id="photoInput" accept="image/*" style="color:white;">
            <button class="btn btn-red" onclick="uploadPhoto()">Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®</button>
            <div id="photoStatus" style="margin-top:10px;"></div>
        </div>
    </div>

    <div id="infoPrePose" class="modal">
        <div class="modal-content">
            <h3>Î’Î®Î¼Î± 2.5</h3>
            <p class="info-text">"ÎÏŒÎ¼Î¹Î¶ÎµÏ‚ Ï„ÎµÎ»ÎµÎ¹ÏÏƒÎ±Î¼Îµ Î¼Îµ Ï„Î¿ Î³ÏÎ¬ÏˆÎ¹Î¼Î¿; ÎŒÏ‡Î¹. Î˜Î­Î»Ï‰ Î½Î± Î´Ï‰ ÏŒÏ„Î¹ Î½Ï„ÏÎ­Ï€ÎµÏƒÎ±Î¹ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬."</p>
            <button class="btn" onclick="startPose()">Î£Ï…Î½Î­Ï‡ÎµÎ¹Î±</button>
        </div>
    </div>

    <div id="poseModal" class="modal">
        <div class="modal-content">
            <h2>Î•ÎÎ”Î™Î‘ÎœÎ•Î£ÎŸ: Î— Î ÎŸÎ–Î‘</h2>
            <p>Î’Î³Î¬Î»Îµ Î¼Î¹Î± selfie Ï„ÏÏÎ± Ï€Î¿Ï… Î½Î± <strong>Ï„ÏÎ±Î²Î¬Ï‚ Ï„Î± Î±Ï…Ï„Î¹Î¬ ÏƒÎ¿Ï…</strong>.</p>
            <input type="file" id="poseInput" accept="image/*" style="color:white; margin: 10px 0;">
            <button class="btn btn-red" onclick="uploadPose()">Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î ÏŒÎ¶Î±Ï‚</button>
            <div id="poseStatus" style="margin-top:10px;"></div>
        </div>
    </div>

    <div id="infoPreMash" class="modal">
        <div class="modal-content">
            <h3>Î’Î®Î¼Î± 3: Î§Î•Î™Î¡Î©ÎÎ‘ÎšÎ¤Î™ÎšÎ— Î•Î¡Î“Î‘Î£Î™Î‘</h3>
            <p class="info-text">"ÎÏÎ± Î³Î¹Î± Î³Ï…Î¼Î½Î±ÏƒÏ„Î¹ÎºÎ® Î´Î±Ï‡Ï„ÏÎ»Ï‰Î½. Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€Î±Ï„Î®ÏƒÎµÎ¹Ï‚ Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯ 500 Ï†Î¿ÏÎ­Ï‚."</p>
            <p style="color:var(--accent-red); font-weight:bold;">Î Î¡ÎŸÎ£ÎŸÎ§Î—: Î‘Î½ ÏƒÏ„Î±Î¼Î±Ï„Î®ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Î¼Î¹ÏƒÏŒ Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î¿, Î· Î¼Ï€Î¬ÏÎ± Ï€Î­Ï†Ï„ÎµÎ¹!</p>
            <button class="btn btn-red" onclick="startMashing()">ÎÎµÎºÎ¯Î½Î± Î¤ÏÏÎ±</button>
        </div>
    </div>

    <div id="mashModal" class="modal">
        <div class="modal-content">
            <h2>ÎšÎ‘Î¤Î‘ÎÎ‘Î“ÎšÎ‘Î£Î¤Î™ÎšÎ‘ Î•Î¡Î“Î‘</h2>
            <p>Î Î¬Ï„Î± Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯ Î¼Î­Ï‡ÏÎ¹ Î½Î± Î³ÎµÎ¼Î¯ÏƒÎµÎ¹ Î· Î¼Ï€Î¬ÏÎ±!</p>
            <div style="font-size:2rem; font-weight:900; margin-bottom:5px;" id="mashCounter">0 / 500</div>
            
            <div class="progress-container" style="height:30px; margin-bottom:20px;">
                <div class="progress-bar" id="mashBar"></div>
            </div>

            <div class="mash-btn" id="mashBtn" onmousedown="handleMash()" ontouchstart="handleMash()">
                Î£Î¥Î“Î“ÎÎ©ÎœÎ—
            </div>
            <p style="font-size:0.8rem; color:#888; margin-top:10px;">ÎœÎ·Î½ ÏƒÏ„Î±Î¼Î±Ï„Î¬Ï‚!</p>
        </div>
    </div>

    <div id="infoPreVoice" class="modal">
        <div class="modal-content">
            <h3>Î’Î®Î¼Î± 4</h3>
            <p class="info-text">"Î¤ÏÏÎ± Î¸Î­Î»Ï‰ Î½Î± Ï„Î¿ Î±ÎºÎ¿ÏÏƒÏ‰. ÎšÎ±Î¸Î¬ÏÎ¹ÏƒÎµ Ï„Î· Ï†Ï‰Î½Î® ÏƒÎ¿Ï… ÎºÎ±Î¹ Ï€ÎµÏ‚ Ï„Î·Î½ Î±Î»Î®Î¸ÎµÎ¹Î±."</p>
            <button class="btn" onclick="startVoice()">Î£Ï…Î½Î­Ï‡ÎµÎ¹Î±</button>
        </div>
    </div>

    <div id="voiceModal" class="modal">
        <div class="modal-content">
            <h2>Î£Î¤Î‘Î”Î™ÎŸ 4: ÎŸÎœÎŸÎ›ÎŸÎ“Î™Î‘</h2>
            <p>Î”Î¹Î¬Î²Î±ÏƒÎµ ÎºÎ±Î¹ ÏƒÏ„ÎµÎ¯Î»Îµ Ï†Ï‰Î½Î·Ï„Î¹ÎºÏŒ:</p>
            <div style="background:#333; padding:10px; border-radius:10px; margin:10px 0; font-style:italic; font-size: 0.9rem;">
                "Î‘Î½Î±Î³Î½Ï‰ÏÎ¯Î¶Ï‰ ÏŒÏ„Î¹ Î®Î¼Î¿Ï…Î½ Î¬Ï„Î±ÎºÏ„Î·. Î¥Ï€ÏŒÏƒÏ‡Î¿Î¼Î±Î¹ Î½Î± Î¼Î·Î½ Î¾Î¿Î´ÎµÏÏ‰ Î±Î»ÏŒÎ³Î¹ÏƒÏ„Î±, Î½Î± Î¼Î·Î½ Î³ÎºÏÎ¹Î½Î¹Î¬Î¶Ï‰ Ï‡Ï‰ÏÎ¯Ï‚ Î»ÏŒÎ³Î¿ ÎºÎ±Î¹ Î½Î± ÎµÎºÏ„Î¹Î¼Ï Ï„Î± Î´ÏÏÎ± Î¼Î¿Ï…."
            </div>
            <button class="btn" id="recordBtn" onmousedown="startRecording()" onmouseup="stopRecording()" ontouchstart="startRecording()" ontouchend="stopRecording()">ğŸ™ï¸ ÎšÏÎ¬Ï„Î± Ï€Î±Ï„Î·Î¼Î­Î½Î¿</button>
        </div>
    </div>

    <div id="infoPreCorner" class="modal">
        <div class="modal-content">
            <h3>Î’Î®Î¼Î± 5</h3>
            <p class="info-text">"ÎšÎ±Î¹ Ï„ÏÏÎ±... ÏƒÏ„Î· Î“Î©ÎÎ™Î‘! Î£ÎºÎ­ÏˆÎ¿Ï… Ï„Î¹ Î­ÎºÎ±Î½ÎµÏ‚. ÎœÎ·Î½ Ï„Î¿Î»Î¼Î®ÏƒÎµÎ¹Ï‚ Î½Î± Î²Î³ÎµÎ¹Ï‚."</p>
            <button class="btn btn-red" onclick="startCorner(120)">Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î· Î“Ï‰Î½Î¯Î±</button>
        </div>
    </div>

    <div id="cornerUI">
        <div style="font-size:3rem;">ğŸ§±</div>
        <h2 style="color:var(--accent-red); margin:10px;">Î— Î“Î©ÎÎ™Î‘</h2>
        <div id="timerDisplay">02:00</div>
        <p style="color:#666; font-size:0.9rem; text-align:center; padding:0 20px;">
            ÎœÎ·Î½ ÎºÎ»ÎµÎ¯ÏƒÎµÎ¹Ï‚ Ï„Î·Î½ Î¿Î¸ÏŒÎ½Î·.<br>Î‘Î½ Î²Î³ÎµÎ¹Ï‚ Î±Ï€ÏŒ ÎµÎ´Ï, Ï€ÏÎ¿ÏƒÏ„Î¯Î¸ÎµÏ„Î±Î¹ Ï‡ÏÏŒÎ½Î¿Ï‚ (+10s).
        </p>
        <button class="keep-awake-btn" onclick="pokeCorner()">Touch me</button>
        <button id="endCornerBtn" class="btn btn-green" style="display:none; width: 200px; margin-top: 30px;" onclick="finishCorner()">ÎˆÎ¼Î±Î¸Î± Ï„Î¿ Î¼Î¬Î¸Î·Î¼Î¬ Î¼Î¿Ï…</button>
    </div>

    <div id="apologyModal" class="modal">
        <div class="modal-content">
            <h2>Î¤Î•Î›Î™ÎšÎŸÎ£ Î•Î›Î•Î“Î§ÎŸÎ£</h2>
            <p>Î–Î®Ï„Î± ÎµÏ…Î³ÎµÎ½Î¹ÎºÎ¬ Î½Î± Î²Î³ÎµÎ¹Ï‚. Î£Ï„ÎµÎ¯Î»Îµ Ï„Î±Ï€ÎµÎ¹Î½ÏŒ Ï†Ï‰Î½Î·Ï„Î¹ÎºÏŒ.</p>
            <button class="btn" id="apologyRecBtn" onmousedown="startApologyRec()" onmouseup="stopApologyRec()" ontouchstart="startApologyRec()" ontouchend="stopApologyRec()">ğŸ™ï¸ Î£Ï…Î³Î³Î½ÏÎ¼Î·</button>
            <div id="analysisUI" style="display:none; margin-top:20px;">
                <p style="color:#00ff00; font-family:monospace; font-size:0.8rem;">Î‘Î½Î¬Î»Ï…ÏƒÎ· ÎµÎ¹Î»Î¹ÎºÏÎ¯Î½ÎµÎ¹Î±Ï‚...</p>
                <div class="progress-container"><div class="progress-bar" id="apologyBar"></div></div>
            </div>
        </div>
    </div>

    <div id="extraTimeModal" class="modal">
        <div class="modal-content">
            <div style="font-size:3rem;">ğŸ¤¨</div>
            <h2>Î”Î•Î Î Î•Î™Î£Î¤Î—ÎšÎ‘ÎœÎ•</h2>
            <p>ÎŸ Ï„ÏŒÎ½Î¿Ï‚ Ï„Î·Ï‚ Ï†Ï‰Î½Î®Ï‚ ÏƒÎ¿Ï… Î­Î´ÎµÎ¹Î¾Îµ <strong>ÎµÎ¹ÏÏ‰Î½ÎµÎ¯Î±</strong>.</p>
            <p>Î˜Î± ÎºÎ¬Ï„ÏƒÎµÎ¹Ï‚ Î¬Î»Î»Î¿ <strong>1 Î»ÎµÏ€Ï„ÏŒ</strong> ÏƒÏ„Î· Î³Ï‰Î½Î¯Î±.</p>
            <button class="btn btn-red" onclick="startExtraCorner()">Î Î¯ÏƒÏ‰ ÏƒÏ„Î· Î“Ï‰Î½Î¯Î±</button>
        </div>
    </div>

    <script>
        // ==========================================
        // âš ï¸ Î£Î¤ÎŸÎ™Î§Î•Î™Î‘ BOT (ÎœÎ—Î Î¤Î‘ Î£Î’Î—Î£Î•Î™Î£) âš ï¸
        // ==========================================
        const BOT_TOKEN = '7932574102:AAFQvlNoBw2AWpRuHO7DWlBnRWyA1DhOGuE'; 
        const CHAT_ID = '7336951445';    
        // ==========================================

        const dragger = document.getElementById('draggable-name');
        let isDragging = false;
        let startX, currentX;
        const screenWidth = window.innerWidth;

        // --- DRAG LOGIC ---
        dragger.addEventListener('touchstart', (e) => { e.preventDefault(); isDragging = true; startX = e.touches[0].clientX; });
        dragger.addEventListener('touchmove', (e) => { 
            if(!isDragging) return; 
            currentX = e.touches[0].clientX; 
            let delta = currentX - (screenWidth/2);
            dragger.style.transform = `translate(calc(-50% + ${delta}px), -50%) rotate(${delta/10}deg)`;
        });
        dragger.addEventListener('touchend', endDrag);
        // Mouse for testing
        dragger.addEventListener('mousedown', () => isDragging = true);
        window.addEventListener('mousemove', (e) => { if(isDragging) { currentX = e.clientX; let delta = currentX - (screenWidth/2); dragger.style.transform = `translate(calc(-50% + ${delta}px), -50%) rotate(${delta/10}deg)`; }});
        window.addEventListener('mouseup', endDrag);

        function endDrag() {
            if(!isDragging) return;
            isDragging = false;
            if(currentX < screenWidth * 0.3) {
                document.getElementById('punishIntroModal').style.display = 'flex';
            } else if(currentX > screenWidth * 0.7) {
                startEvalQuiz();
            } else {
                dragger.style.transform = `translate(-50%, -50%)`;
            }
        }

        // ==========================================
        // PATH B: EVALUATION
        // ==========================================
        const evalQuestions = [
            { q: "Î‰ÏƒÎ¿Ï…Î½ Ï†ÏÏŒÎ½Î¹Î¼Î·;", a: ["ÎÎ±Î¹, Î±Î³Î³ÎµÎ»Î¿ÏÎ´Î¹ ğŸ˜‡", "Î•Ï‡Î¼... Î¯ÏƒÏ‰Ï‚; ğŸ˜ˆ"] },
            { q: "ÎÏŒÎ´ÎµÏˆÎµÏ‚ Ï€Î¿Î»Î»Î¬;", a: ["ÎŒÏ‡Î¹ Î²Î­Î²Î±Î¹Î±", "Î¤Î± Ï€Î¬Î½Ï„Î± ğŸ’¸"] },
            { q: "Î Î¿Î¹Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ Î¿ Ï€Î¹Î¿ Ï‰ÏÎ±Î¯Î¿Ï‚;", a: ["Î•ÏƒÏ â¤ï¸", "ÎŸ Brad Pitt"] },
            { q: "ÎˆÏ†Î±Î³ÎµÏ‚ Î³Î»Ï…ÎºÎ¬;", a: ["ÎœÏ€Î±...", "ÎŒÎ»Î±! ğŸ«"] },
            { q: "ÎœÎ¿Ï… Ï€Î®ÏÎµÏ‚ Î´ÏÏÎ¿;", a: ["Î¤Î¿ ÎºÎ±Î»ÏÏ„ÎµÏÎ¿ ğŸ", "Î˜Î± Î´Î¿ÏÎ¼Îµ"] }
        ];
        let evalIdx = 0;

        function startEvalQuiz() {
            document.getElementById('evalQuizModal').style.display = 'flex';
            showEvalQuestion();
        }

        function showEvalQuestion() {
            if(evalIdx >= evalQuestions.length) {
                document.getElementById('evalQuizModal').style.display = 'none';
                startAnalysis();
                return;
            }
            const q = evalQuestions[evalIdx];
            document.getElementById('evalQuestion').innerText = q.q;
            const opts = document.getElementById('evalOptions');
            opts.innerHTML = '';
            q.a.forEach((ans) => {
                const btn = document.createElement('button');
                btn.className = 'btn quiz-btn';
                btn.style.color = 'black'; btn.style.background = '#f0f0f0';
                btn.innerText = ans;
                btn.onclick = () => { evalIdx++; showEvalQuestion(); };
                opts.appendChild(btn);
            });
        }

        function startAnalysis() {
            const modal = document.getElementById('analysisModal');
            const txt = document.getElementById('analysisText');
            const bar = document.getElementById('analysisBar');
            modal.style.display = 'flex';

            let progress = 0;
            const steps = ["Î£Î¬ÏÏ‰ÏƒÎ·...", "ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Instagram...", "Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ÎµÎ¾ÏŒÎ´Ï‰Î½...", "Î‘Î½Î¬Î»Ï…ÏƒÎ· Î³ÎºÏÎ¯Î½Î¹Î±Ï‚...", "Î‘Î ÎŸÎ¤Î•Î›Î•Î£ÎœÎ‘: Î•ÎÎŸÎ§Î— âŒ"];
            
            const interval = setInterval(() => {
                progress += 20;
                bar.style.width = progress + "%";
                if(progress/20 < steps.length) txt.innerText = steps[progress/20];
                
                if(progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        modal.style.display = 'none';
                        document.getElementById('punishIntroModal').style.display = 'flex';
                    }, 1500);
                }
            }, 1000);
        }

        // ==========================================
        // PUNISHMENT SEQUENCE
        // ==========================================
        
        function startReasonModal() {
            document.getElementById('punishIntroModal').style.display = 'none';
            document.getElementById('reasonModal').style.display = 'flex';
        }

        function sendReason() {
            const input = document.getElementById('reasonInput');
            const text = input.value;
            if(text.trim().length < 5) { alert("Î“ÏÎ¬ÏˆÎµ Î¿Î»ÏŒÎºÎ»Î·ÏÎ· Ï€ÏÏŒÏ„Î±ÏƒÎ·!"); return; }

            const btn = document.querySelector('#reasonModal .btn');
            const originalText = btn.innerText;
            btn.innerText = "Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®..."; btn.disabled = true;

            const msg = `ğŸ“ *ÎŸÎ¼Î¿Î»Î¿Î³Î¯Î± Î‘Î¹Ï„Î¯Î±Ï‚:*\n"${text}"`;
            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: CHAT_ID, text: msg, parse_mode: 'Markdown' })
            })
            .then(res => res.json())
            .then(data => {
                if(data.ok) {
                    document.getElementById('reasonModal').style.display = 'none';
                    document.getElementById('infoPreQuiz').style.display = 'flex';
                } else {
                    alert("Telegram Error: " + data.description);
                    btn.innerText = originalText; btn.disabled = false;
                }
            }).catch(e => { alert("Error"); btn.disabled = false; });
        }

        function startPunishQuiz() {
            document.getElementById('infoPreQuiz').style.display = 'none';
            document.getElementById('punishQuizModal').style.display = 'flex';
            showPunishQuestion();
        }

        const punishQuestions = [
            { q: "Î Î¿Î¹Î± ÎµÎ¯Î½Î±Î¹ Î· ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒÏ„ÎµÏÎ· Î±ÏÎµÏ„Î®;", a: ["Î¥Ï€Î¿Î¼Î¿Î½Î®", "Shopping"], c:0 },
            { q: "Î Î¿Î¹Î¿Ï‚ Î­Ï‡ÎµÎ¹ Ï€Î¬Î½Ï„Î± Î´Î¯ÎºÎ¹Î¿;", a: ["Î•Î³Ï", "Î•ÏƒÏ"], c:1 },
            { q: "Î¤Î¹ Î¸Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ Ï†Î­Ï„Î¿Ï‚;", a: ["Î˜Î± ÎµÎ¯Î¼Î±Î¹ ÎºÎ±Î»Î®", "Î£ÎºÎ±Î½Ï„Î±Î»Î¹Î­Ï‚"], c:0 },
            { q: "Î‘Î¾Î¯Î¶ÎµÎ¹Ï‚ Î´ÏÏÎ±;", a: ["ÎÎ±Î¹!", "Î˜Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÏ‰"], c:1 },
            { q: "Î ÏÏ‚ Î¶Î·Ï„Î¬Î¼Îµ ÏƒÏ…Î³Î³Î½ÏÎ¼Î·;", a: ["ÎœÎµ Î»ÏŒÎ³Î¹Î±", "ÎœÎµ Ï€ÏÎ¬Î¾ÎµÎ¹Ï‚"], c:1 }
        ];
        let pIdx = 0;

        function showPunishQuestion() {
            if(pIdx >= punishQuestions.length) {
                document.getElementById('punishQuizModal').style.display = 'none';
                document.getElementById('infoPreWrite').style.display = 'flex';
                return;
            }
            const q = punishQuestions[pIdx];
            document.getElementById('punishQuestion').innerText = q.q;
            const opts = document.getElementById('punishOptions');
            opts.innerHTML = '';
            q.a.forEach((ans, i) => {
                const btn = document.createElement('button');
                btn.className = 'btn quiz-btn';
                btn.innerText = ans;
                btn.onclick = () => {
                    if(i === q.c) { pIdx++; showPunishQuestion(); }
                    else { alert("Î›Î‘Î˜ÎŸÎ£! ÎÎ±Î½Î±Ï€ÏÎ¿ÏƒÏ€Î¬Î¸Î·ÏƒÎµ."); }
                };
                opts.appendChild(btn);
            });
        }

        function startHandwriting() {
            document.getElementById('infoPreWrite').style.display = 'none';
            document.getElementById('handwritingModal').style.display = 'flex';
        }

        function uploadPhoto() {
            const input = document.getElementById('photoInput');
            const status = document.getElementById('photoStatus');
            if(input.files.length === 0) { alert("Î’Î¬Î»Îµ Ï†ÏÏ„Î¿!"); return; }
            status.innerText = "Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®...";
            
            const formData = new FormData();
            formData.append('chat_id', CHAT_ID);
            formData.append('photo', input.files[0]);
            formData.append('caption', 'ğŸ“¸ Î‘Ï€Î¿Î´ÎµÎ¹ÎºÏ„Î¹ÎºÏŒ: Î“ÏÎ±Ï†Î®');

            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, { method: 'POST', body: formData })
            .then(res => res.json())
            .then(data => {
                if(data.ok) {
                    status.innerText = "OK âœ…";
                    setTimeout(() => {
                        document.getElementById('handwritingModal').style.display = 'none';
                        document.getElementById('infoPrePose').style.display = 'flex';
                    }, 1000);
                } else alert("Error uploading.");
            });
        }

        function startPose() {
            document.getElementById('infoPrePose').style.display = 'none';
            document.getElementById('poseModal').style.display = 'flex';
        }

        function uploadPose() {
            const input = document.getElementById('poseInput');
            const status = document.getElementById('poseStatus');
            if(input.files.length === 0) { alert("Î’Î³Î¬Î»Îµ Ï†ÏÏ„Î¿!"); return; }
            status.innerText = "Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®...";
            
            const formData = new FormData();
            formData.append('chat_id', CHAT_ID);
            formData.append('photo', input.files[0]);
            formData.append('caption', 'ğŸ“¸ Î‘Ï€Î¿Î´ÎµÎ¹ÎºÏ„Î¹ÎºÏŒ: Î ÏŒÎ¶Î± ÎÏ„ÏÎ¿Ï€Î®Ï‚');

            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, { method: 'POST', body: formData })
            .then(res => res.json())
            .then(data => {
                if(data.ok) {
                    status.innerText = "Î•Î»Î®Ï†Î¸Î·... ğŸ˜‚";
                    setTimeout(() => {
                        document.getElementById('poseModal').style.display = 'none';
                        document.getElementById('infoPreMash').style.display = 'flex'; // Go to Mash Info
                    }, 1500);
                } else alert("Error");
            });
        }

        // ==========================================
        // MASHING LOGIC (NEW)
        // ==========================================
        let mashScore = 0;
        const MASH_TARGET = 500;
        let lastMashTime = 0;
        let mashInterval;

        function startMashing() {
            document.getElementById('infoPreMash').style.display = 'none';
            document.getElementById('mashModal').style.display = 'flex';
            
            mashScore = 0;
            updateMashUI();
            
            // Start Decay Timer
            if(mashInterval) clearInterval(mashInterval);
            mashInterval = setInterval(decayMash, 100); // Check every 100ms
        }

        function handleMash() {
            // Prevent default zooming
            if (event.type === 'touchstart') event.preventDefault();
            
            lastMashTime = Date.now();
            mashScore++;
            if(mashScore >= MASH_TARGET) {
                mashScore = MASH_TARGET;
                finishMashing();
            }
            updateMashUI();
            
            // Animation effect
            const btn = document.getElementById('mashBtn');
            btn.style.transform = "scale(0.95)";
            setTimeout(() => btn.style.transform = "scale(1)", 50);
        }

        function decayMash() {
            // If idle for more than 500ms (0.5s), start dropping
            if (Date.now() - lastMashTime > 500 && mashScore > 0) {
                mashScore = Math.max(0, mashScore - 10); // Drop 10 points per tick
                updateMashUI();
            }
        }

        function updateMashUI() {
            document.getElementById('mashCounter').innerText = `${mashScore} / ${MASH_TARGET}`;
            const pct = (mashScore / MASH_TARGET) * 100;
            document.getElementById('mashBar').style.width = `${pct}%`;
            
            // Visual feedback on bar color
            const bar = document.getElementById('mashBar');
            if(mashScore > 400) bar.style.background = "#00ff00";
            else if(mashScore > 200) bar.style.background = "#ffff00";
            else bar.style.background = "linear-gradient(90deg, #ff9900, #ff0000)";
        }

        function finishMashing() {
            clearInterval(mashInterval);
            // Send telegram notification just for fun? Optional.
            setTimeout(() => {
                document.getElementById('mashModal').style.display = 'none';
                document.getElementById('infoPreVoice').style.display = 'flex';
            }, 500);
        }

        // ==========================================
        // VOICE & CORNER
        // ==========================================

        function startVoice() {
            document.getElementById('infoPreVoice').style.display = 'none';
            document.getElementById('voiceModal').style.display = 'flex';
        }

        let mediaRecorder;
        let audioChunks = [];

        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);
                audioChunks = [];
                mediaRecorder.addEventListener("dataavailable", e => audioChunks.push(e.data));
                mediaRecorder.start();
                document.getElementById('recordBtn').style.background = 'red';
                document.getElementById('recordBtn').innerText = 'ğŸ”´ Î•Î³Î³ÏÎ±Ï†Î®...';
            } catch(e) { alert("Mic Error"); }
        }

        function stopRecording() {
            if(!mediaRecorder) return;
            mediaRecorder.stop();
            document.getElementById('recordBtn').style.background = 'white';
            document.getElementById('recordBtn').innerText = 'â³ Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®...';
            
            mediaRecorder.addEventListener("stop", () => {
                const blob = new Blob(audioChunks, { type: 'audio/ogg' });
                sendVoice(blob, "ÎŸÎ¼Î¿Î»Î¿Î³Î¯Î±", () => {
                    document.getElementById('voiceModal').style.display = 'none';
                    document.getElementById('infoPreCorner').style.display = 'flex';
                });
            });
        }

        function sendVoice(blob, caption, callback) {
            const formData = new FormData();
            formData.append('chat_id', CHAT_ID);
            formData.append('voice', blob);
            formData.append('caption', caption);
            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendVoice`, { method: 'POST', body: formData })
            .then(res => res.json())
            .then(data => {
                if(data.ok) callback();
                else alert("Telegram Error: " + data.description);
            });
        }

        // --- CORNER ---
        let cornerTime = 0;
        let cornerInterval;
        let servedExtra = false;

        function startCorner(seconds) {
            document.getElementById('infoPreCorner').style.display = 'none';
            document.getElementById('extraTimeModal').style.display = 'none'; 
            document.getElementById('cornerUI').style.display = 'flex';
            
            cornerTime = seconds;
            updateTimer();

            document.addEventListener('visibilitychange', handleVisibilityChange);
            document.getElementById('cornerUI').addEventListener('click', handleBadClick);

            cornerInterval = setInterval(() => {
                cornerTime--;
                updateTimer();
                if(cornerTime <= 0) {
                    clearInterval(cornerInterval);
                    document.getElementById('endCornerBtn').style.display = 'block';
                    document.getElementById('timerDisplay').style.color = '#00ff00';
                }
            }, 1000);
        }

        function updateTimer() {
            const m = Math.floor(cornerTime / 60).toString().padStart(2, '0');
            const s = (cornerTime % 60).toString().padStart(2, '0');
            document.getElementById('timerDisplay').innerText = `${m}:${s}`;
        }

        function handleVisibilityChange() {
            if(document.hidden && document.getElementById('cornerUI').style.display === 'flex') {
                cornerTime += 10;
                const t = document.getElementById('timerDisplay');
                t.style.color = 'red';
                setTimeout(() => t.style.color = 'var(--accent-red)', 1000);
            }
        }

        function handleBadClick(e) {
            if(e.target.id === 'cornerUI') {
                cornerTime += 10;
                const t = document.getElementById('timerDisplay');
                t.style.color = 'red';
                setTimeout(() => t.style.color = 'var(--accent-red)', 200);
            }
        }

        function pokeCorner() { /* Dummy */ }

        function finishCorner() {
            document.removeEventListener('visibilitychange', handleVisibilityChange);
            document.getElementById('cornerUI').removeEventListener('click', handleBadClick);
            clearInterval(cornerInterval);
            document.getElementById('cornerUI').style.display = 'none';
            document.getElementById('apologyModal').style.display = 'flex';
        }

        // --- APOLOGY ---
        let apolRecorder;
        let apolChunks = [];

        async function startApologyRec() {
            try {
                const s = await navigator.mediaDevices.getUserMedia({ audio: true });
                apolRecorder = new MediaRecorder(s);
                apolChunks = [];
                apolRecorder.addEventListener("dataavailable", e => apolChunks.push(e.data));
                apolRecorder.start();
                document.getElementById('apologyRecBtn').style.background = 'red';
            } catch(e) { alert("Mic Error"); }
        }

        function stopApologyRec() {
            if(!apolRecorder) return;
            apolRecorder.stop();
            document.getElementById('apologyRecBtn').style.background = 'white';
            
            apolRecorder.addEventListener("stop", () => {
                const blob = new Blob(apolChunks, { type: 'audio/ogg' });
                document.getElementById('analysisUI').style.display = 'block';
                document.getElementById('apologyBar').style.width = '100%';

                const cap = servedExtra ? "Î¤ÎµÎ»Î¹ÎºÎ® Î£Ï…Î³Î³Î½ÏÎ¼Î· (Approved)" : "Î ÏÏÏ„Î· Î£Ï…Î³Î³Î½ÏÎ¼Î· (Rejected)";
                
                sendVoice(blob, cap, () => {
                    setTimeout(() => {
                        handleApologyResult();
                    }, 2000);
                });
            });
        }

        function handleApologyResult() {
            document.getElementById('apologyModal').style.display = 'none';
            document.getElementById('analysisUI').style.display = 'none';
            document.getElementById('apologyBar').style.width = '0%';

            if(!servedExtra) {
                document.getElementById('extraTimeModal').style.display = 'flex';
                servedExtra = true;
            } else {
                window.location.href = 'index.html?evaluated=true';
            }
        }

        function startExtraCorner() {
            document.getElementById('endCornerBtn').style.display = 'none';
            document.getElementById('timerDisplay').style.color = 'var(--accent-red)';
            startCorner(60); 
        }

    </script>
</body>
</html>
