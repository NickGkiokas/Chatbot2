<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î¤ÎµÎ»Î¹ÎºÎ® Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· âœ…</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #c0392b;
            --secondary: #27ae60;
            --dark: #2c3e50;
            --bg: #f5f7fa;
        }

        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 20px; color: var(--dark); }
        
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        
        h1 { text-align: center; color: var(--primary); }
        .subtitle { text-align: center; color: #777; margin-bottom: 30px; }

        /* Mode Selection Buttons */
        .mode-selection { display: flex; gap: 20px; justify-content: center; margin-bottom: 30px; }
        .mode-btn {
            padding: 20px; width: 45%; border: 2px solid #ddd; border-radius: 12px; 
            background: white; cursor: pointer; transition: 0.3s; text-align: center;
        }
        .mode-btn:hover { border-color: var(--primary); transform: translateY(-3px); }
        .mode-btn.active { border-color: var(--primary); background: #fff5f5; }
        .mode-icon { font-size: 2rem; display: block; margin-bottom: 10px; }
        .mode-title { font-weight: bold; font-size: 1.1rem; }
        .mode-desc { font-size: 0.85rem; color: #666; }

        /* Questions Form */
        #quiz-section { display: none; animation: fadeIn 0.5s; }
        .question-card { margin-bottom: 25px; border-bottom: 1px dashed #eee; padding-bottom: 20px; }
        .q-title { font-weight: bold; margin-bottom: 10px; display: block; color: var(--dark); font-size: 1.1rem; }
        
        /* Written Input */
        .q-input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-family: inherit; box-sizing: border-box; }
        
        /* Audio Input */
        .audio-controls { display: flex; align-items: center; gap: 15px; }
        .record-btn {
            background: var(--dark); color: white; border: none; padding: 10px 20px; 
            border-radius: 30px; cursor: pointer; display: flex; align-items: center; gap: 8px;
            transition: 0.2s;
        }
        .record-btn.recording { background: red; animation: pulse 1.5s infinite; }
        .rec-status { font-size: 0.9rem; color: var(--secondary); display: none; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(255, 0, 0, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); } }
        @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

        /* Final Submit */
        .submit-section { text-align: center; margin-top: 40px; border-top: 2px solid #eee; padding-top: 20px; display: none; }
        .final-btn { background: var(--secondary); color: white; border: none; padding: 15px 40px; border-radius: 8px; font-size: 1.2rem; cursor: pointer; font-weight: bold; }
        .final-btn:hover { opacity: 0.9; }

        /* Success Overlay */
        #success-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--secondary);
            z-index: 5000; display: none; flex-direction: column; justify-content: center; align-items: center; color: white; text-align: center;
        }
        .success-icon { font-size: 5rem; margin-bottom: 20px; }

    </style>
</head>
<body>

    <div class="container" id="main-container">
        <h1>ğŸ” ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ ÎšÎ±Ï„Î±Î½ÏŒÎ·ÏƒÎ·Ï‚</h1>
        <p class="subtitle">Î“Î¹Î± Î½Î± Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¸ÎµÎ¯ Î· ÏƒÏ…Î¼Ï†Ï‰Î½Î¯Î±, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ ÏƒÏ‰ÏƒÏ„Î¬ ÏƒÏ„Î¹Ï‚ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚.</p>

        <div class="mode-selection">
            <button class="mode-btn" onclick="selectMode('written')">
                <span class="mode-icon">ğŸ“</span>
                <span class="mode-title">Î“ÏÎ±Ï€Ï„Î¬</span>
                <span class="mode-desc">(Î•Ï€Î¹Î»Î¿Î³Î® Î±Î½ ÎµÎ¯ÏƒÎ±Î¹ Î¼ÏŒÎ½Î· ÏƒÎ¿Ï…)</span>
            </button>
            <button class="mode-btn" onclick="selectMode('oral')">
                <span class="mode-icon">ğŸ™ï¸</span>
                <span class="mode-title">Î ÏÎ¿Ï†Î¿ÏÎ¹ÎºÎ¬</span>
                <span class="mode-desc">(Î•Ï€Î¹Î»Î¿Î³Î® Î±Î½ ÎµÎ¯ÏƒÎ±Î¹ Î¼Îµ Ï„Î¿Î½ Îº. Î“ÎºÎ¹ÏÎºÎ±)</span>
            </button>
        </div>

        <div id="quiz-section">
            <div id="questions-container">
                </div>
        </div>

        <div class="submit-section" id="submit-section">
            <p style="margin-bottom:15px; font-size:0.9rem; color:#666;">
                Î Î±Ï„ÏÎ½Ï„Î±Ï‚ Ï…Ï€Î¿Î²Î¿Î»Î®, ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹ÏÎ½ÎµÎ¹Ï‚ ÏŒÏ„Î¹ ÎºÎ±Ï„Î¬Î»Î±Î²ÎµÏ‚ Ï€Î»Î®ÏÏ‰Ï‚ Ï„Î¿Ï…Ï‚ ÏŒÏÎ¿Ï…Ï‚.
            </p>
            <button class="final-btn" onclick="finalSubmit()">Î¤ÎµÎ»Î¹ÎºÎ® Î¥Ï€Î¿Î²Î¿Î»Î®</button>
        </div>
    </div>

    <div id="success-screen">
        <div class="success-icon">âœ…</div>
        <h1>Î¤Î­Î»Î¿Ï‚!</h1>
        <p style="font-size:1.5rem;">ÎœÏ€Î¿ÏÎµÎ¯Ï‚ Î½Î± Î±Ï€Î¿Ï‡Ï‰ÏÎ®ÏƒÎµÎ¹Ï‚.</p>
        <p style="margin-top:20px; opacity:0.8;">Î— ÏƒÏ…Î¼Ï†Ï‰Î½Î¯Î± ÎºÎ±Ï„Î¿Ï‡Ï…ÏÏÎ¸Î·ÎºÎµ.</p>
        <p style="margin-top:50px; font-size:0.8rem;">Argos System v2.0</p>
    </div>

    <script>
        // --- Î¡Î¥Î˜ÎœÎ™Î£Î•Î™Î£ TELEGRAM (Î™Î”Î™Î•Î£ ÎœÎ• Î Î¡Î™Î) ---
        const TG_BOT_TOKEN = "7932574102:AAFQvlNoBw2AWpRuHO7DWlBnRWyA1DhOGuE"; 
        const TG_CHAT_ID = "7336951445"; 

        const questions = [
            "1. Î¤Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏƒÏ„Î¿ ÎºÎ±Î»Î¬Î¸Î¹ Î±Î½ Ï„Î¿ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ Ï„Ï‰Î½ Ï€ÏŒÎ½Ï„Ï‰Î½ Î³Î¯Î½ÎµÎ¹ Î±ÏÎ½Î·Ï„Î¹ÎºÏŒ;",
            "2. Î ÏÏ‚ Î¼Ï€Î¿ÏÎµÎ¯Ï‚ Î½Î± ÎºÎµÏÎ´Î¯ÏƒÎµÎ¹Ï‚ Ï€ÏŒÎ½Ï„Î¿Ï…Ï‚ Î³Î¹Î± Î½Î± Î¾ÎµÎ¼Ï€Î»Î¿ÎºÎ¬ÏÎµÎ¹Ï‚ Ï„Î¹Ï‚ Î±Î³Î¿ÏÎ­Ï‚;",
            "3. Î¤Î¹ Î¹ÏƒÏ‡ÏÎµÎ¹ Î³Î¹Î± Ï„Î¿ ÏŒÏÎ¹Î¿ Î±Î³Î¿ÏÏÎ½ ÏƒÏ„Î·Î½ '1 ÎœÎ­ÏÎ± Î†Î´ÎµÎ¹Î±';",
            "4. Î‘Î½ Î´ÎµÎ½ Ï„Î·ÏÎ·Î¸ÎµÎ¯ Î· ÏƒÏ…Î¼Ï†Ï‰Î½Î¯Î± (Ï€.Ï‡. Î¼ÎµÎ¸ÏÏƒÎ¹), Ï„Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ Î¼Îµ Ï„Î·Î½ Î¤Î¹Î¼Ï‰ÏÎ¯Î±;",
            "5. Î Î¿Î¹Î¿Ï‚ Î­Ï‡ÎµÎ¹ Ï€Î¬Î½Ï„Î± Î´Î¯ÎºÎ¹Î¿ ÏƒÎµ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Î´Î¹Î±Ï†Ï‰Î½Î¯Î±Ï‚;"
        ];

        let currentMode = null;
        let mediaRecorders = {}; // Store recorders per question

        function selectMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            renderQuestions();
            document.getElementById('quiz-section').style.display = 'block';
            document.getElementById('submit-section').style.display = 'block';
        }

        function renderQuestions() {
            const container = document.getElementById('questions-container');
            container.innerHTML = '';

            questions.forEach((q, index) => {
                const div = document.createElement('div');
                div.className = 'question-card';
                
                let inputHTML = '';
                if (currentMode === 'written') {
                    inputHTML = `<input type="text" id="ans-${index}" class="q-input" placeholder="Î“ÏÎ¬ÏˆÎµ Ï„Î·Î½ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ® ÏƒÎ¿Ï…...">`;
                } else {
                    inputHTML = `
                        <div class="audio-controls">
                            <button class="record-btn" id="btn-rec-${index}" onmousedown="startRecording(${index})" onmouseup="stopRecording(${index})" ontouchstart="startRecording(${index})" ontouchend="stopRecording(${index})">
                                <i class="fas fa-microphone"></i> ÎšÏÎ¬Ï„Î± Î³Î¹Î± ÎµÎ³Î³ÏÎ±Ï†Î®
                            </button>
                            <span class="rec-status" id="status-${index}"><i class="fas fa-check"></i> Î•ÏƒÏ„Î¬Î»Î·!</span>
                        </div>
                        <small style="color:#888; display:block; margin-top:5px;">* ÎšÏÎ¬Ï„Î± Ï€Î±Ï„Î·Î¼Î­Î½Î¿ Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯, Î¼Î¯Î»Î±, ÎºÎ±Î¹ Î¬ÏƒÎµ Ï„Î¿ Î³Î¹Î± Î±Ï€Î¿ÏƒÏ„Î¿Î»Î®.</small>
                    `;
                }

                div.innerHTML = `
                    <label class="q-title">${q}</label>
                    ${inputHTML}
                `;
                container.appendChild(div);
            });
        }

        // --- WRITTEN SUBMISSION ---
        function submitWritten() {
            let msg = "ğŸ“ *Î‘Î Î‘ÎÎ¤Î—Î£Î•Î™Î£ ÎšÎ‘Î¤Î‘ÎÎŸÎ—Î£Î—Î£ (Î“Î¡Î‘Î Î¤Î‘)*\n\n";
            let allFilled = true;

            questions.forEach((q, index) => {
                const ans = document.getElementById(`ans-${index}`).value;
                if(!ans) allFilled = false;
                msg += `*Q${index+1}:* ${q}\n*A:* ${ans}\n\n`;
            });

            if(!allFilled) return alert("Î Î±ÏÎ±ÎºÎ±Î»Ï Î±Ï€Î¬Î½Ï„Î·ÏƒÎµ ÏƒÎµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚!");

            sendTelegramText(msg);
            showSuccess();
        }

        // --- ORAL LOGIC (VOICE RECORDING) ---
        let activeRecorder = null;
        let audioChunks = [];

        async function startRecording(index) {
            if (activeRecorder) return; // Prevent double click

            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                const btn = document.getElementById(`btn-rec-${index}`);
                
                activeRecorder = new MediaRecorder(stream);
                audioChunks = [];

                activeRecorder.ondataavailable = event => {
                    audioChunks.push(event.data);
                };

                activeRecorder.onstop = () => {
                    const audioBlob = new Blob(audioChunks, { type: 'audio/ogg; codecs=opus' });
                    sendTelegramVoice(audioBlob, `Question ${index+1}`);
                    
                    // Update UI
                    document.getElementById(`status-${index}`).style.display = 'inline';
                    btn.classList.remove('recording');
                    btn.innerHTML = '<i class="fas fa-microphone"></i> Î—Ï‡Î¿Î³ÏÎ±Ï†Î®Î¸Î·ÎºÎµ';
                    btn.style.background = '#27ae60';
                };

                activeRecorder.start();
                btn.classList.add('recording');
                btn.innerHTML = '<i class="fas fa-circle"></i> Î•Î³Î³ÏÎ±Ï†Î®...';

            } catch (err) {
                alert("Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ Î¼Î¹ÎºÏÏŒÏ†Ï‰Î½Î¿ Î® Î´ÎµÎ½ Î´ÏŒÎ¸Î·ÎºÎµ Î¬Î´ÎµÎ¹Î±! " + err);
            }
        }

        function stopRecording(index) {
            if (activeRecorder && activeRecorder.state !== "inactive") {
                activeRecorder.stop();
                activeRecorder.stream.getTracks().forEach(track => track.stop()); // Stop stream
                activeRecorder = null;
            }
        }

        // --- TELEGRAM FUNCTIONS ---
        function sendTelegramText(text) {
            const url = `https://api.telegram.org/bot${TG_BOT_TOKEN}/sendMessage?chat_id=${TG_CHAT_ID}&text=${encodeURIComponent(text)}&parse_mode=Markdown`;
            fetch(url, { mode: 'no-cors' }).catch(e => console.error(e));
        }

        function sendTelegramVoice(blob, caption) {
            const formData = new FormData();
            formData.append('chat_id', TG_CHAT_ID);
            formData.append('voice', blob, 'voice.ogg');
            formData.append('caption', `ğŸ™ï¸ Î‘Ï€Î¬Î½Ï„Î·ÏƒÎ· ÏƒÏ„Î·Î½: ${caption}`);

            fetch(`https://api.telegram.org/bot${TG_BOT_TOKEN}/sendVoice`, {
                method: 'POST',
                body: formData
            })
            .then(res => console.log("Voice sent"))
            .catch(err => console.error("Voice failed", err));
        }

        // --- FINAL SUBMIT ---
        function finalSubmit() {
            if (currentMode === 'written') {
                submitWritten();
            } else {
                // For oral, answers are sent instantly. We just confirm end of session.
                sendTelegramText("ğŸ *Î— ÎŒÎ¼Î¿ÏÏ†Î· Ï„Î¿Ï… Î†ÏÎ³Î¿Ï…Ï‚ Î¿Î»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎµ Ï„Î·Î½ Ï€ÏÎ¿Ï†Î¿ÏÎ¹ÎºÎ® ÎµÎ¾Î­Ï„Î±ÏƒÎ·.*");
                showSuccess();
            }
        }

        function showSuccess() {
            document.getElementById('success-screen').style.display = 'flex';
        }

    </script>
</body>
</html>
